已有一份包含多个股票的日频行情数据，以及未来1日的收益率（label）。请完成以下任务：

**一、因子库构建（20分）**

使用提供的日频数据（含 open, high, low, close, volume, amount 等字段），参考 Alpha101 和 Alpha191（见参考资料），构造自己的因子库。单个因子值可以保存为一个 DataFrame，行索引为日期，列为股票代码，值为因子值。所有因子值可以合并为一个 DataFrame，MultiIndex\[日期，股票代码]。

---

**二、简易因子回测框架（20分）**

实现一个简易的因子评估框架，支持以下功能：
- 因子 IC（Information Coefficient）评估；
- 年化分组多空、多头收益率（top20% - bottom20%）；
- 年化多空、多头夏普率；
- 可视化输出因子表现（IC 曲线、分组收益率、分组净值曲线等）。

---

**三、因子筛选（20分）**

对因子进行筛选，以提升表现（滚动筛选），可选的方式如下：
- 方法一：基于 IC、Sharpe 等指标筛选；
- 方法二：使用 Lasso/Ridge/ElasticNet 等线性模型进行筛选。
- 其他..

---

**四、构建预测模型（20分）**

先使用所有因子构建 base 模型（滚动训练/预测）；然后筛选的因子构建模型（滚动训练/预测）：
- 可选模型：线性模型（如线性回归、岭回归）或非线性模型（如 RandomForest, XGBoost, LightGBM）；建议线性一种和非线性一种，总不超过 2 种模型。
- 目标变量：未来一日收益率；

**五、预测信号回测（20分）**

基于模型预测的每个交易日每支股票的预测收益率构建截面策略（投资组合）
（如：预测收益 top 10% 的股票等权持有）并进行回测（考虑手续费 0.1%）；

输出以下指标：
年化收益率、夏普率、最大回撤、累计收益图。

---

**六、选做题：Barra 风格分析**

对投资组合进行解释性分析：
使用 Barra 风格因子（如 Size、Momentum、Beta、Volatility、EarningYield 等），分析预测收益的来源。
提示：截面回归得到各风格因子的收益率和 alpha，计算投资组合在各风格因子上的暴露。
